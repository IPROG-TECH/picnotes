<script>

  document.getElementById("defaultOpen").click();

  // function openReference(evt, tab){
  //   var i;
  //   var x = document.getElementsByClassName('click-reference');
  //   for (i = 0; i < x.length; i++) {
  //     x[i].style.display = 'none';
  //     x[i].style.borderBottom = 'thick #fff solid';
  //   }
  //   document.getElementById(tab).style.display = 'block';
  // }

  // function openTab(evt, tabName) {
  //     // Declare all variables
  //     var i, tabcontent, tablinks;
  //
  //     // Get all elements with class="tabcontent" and hide them
  //     tabcontent = document.getElementsByClassName("click-reference");
  //     for (i = 0; i < tabcontent.length; i++) {
  //         tabcontent[i].style.display = "none";
  //     }
  //
  //     // Get all elements with class="tablinks" and remove the class "active"
  //     tablinks = document.getElementsByClassName("tablinks");
  //     for (i = 0; i < tablinks.length; i++) {
  //         tablinks[i].className = tablinks[i].className.replace(" active", "");
  //     }
  //
  //     // Show the current tab, and add an "active" class to the button that opened the tab
  //     document.getElementById(tabName).style.display = "block";
  //     evt.currentTarget.className += " active";
  // }

  function openReference(evt, tab) {
  // Declare all variables
  var i, tabcontent, tablinks;

  // Get all elements with class="tabcontent" and hide them
  tabcontent = document.getElementsByClassName("click-reference");
  for (i = 0; i < tabcontent.length; i++) {
    tabcontent[i].style.display = "none";
  }

  // Get all elements with class="tablinks" and remove the class "active"
  tablinks = document.getElementsByClassName("reference-tab");
  for (i = 0; i < tablinks.length; i++) {
    tablinks[i].className = tablinks[i].className.replace(" active", "");
  }

  // Show the current tab, and add an "active" class to the button that opened the tab
  document.getElementById(tab).style.display = "block";
  evt.currentTarget.className += " active";
}

</script>

<div id = 'references' class = 'tabcontent'>
  <div class = 'reference-tabs'>
    <% if current_user %>
      <% if current_user.username == @note.user.username %>
      <button class = 'reference-tab Add active' id = 'defaultOpen' onclick='openReference(event, "Add")'> Add </button>
      <% end %>
    <% end %>
    <% if @textbooks.count > 0 %>
      <button class = 'reference-tab Textbooks' onclick='openReference("Textbooks")'> Books <%= @textbooks.count%>  </button>
    <% else %>
      <button class = 'reference-tab Textbooks' onclick='openReference("Textbooks")'> Book <%= @textbooks.count%>  </button>
    <%end %>
    <% if @videos.count > 0 %>
      <button class = 'reference-tab Videos' onclick='openReference("Videos")'> Videos <%= @videos.count%>  </button>
    <% else %>
      <button class = 'reference-tab Videos' onclick='openReference("Videos")'> Video <%= @videos.count%>  </button>
    <% end %>
    <% if @papers.count > 0 %>
      <button class = 'reference-tab Papers' onclick='openReference("Papers")'> Articles <%= @papers.count%>  </button>
    <% else %>
      <button class = 'reference-tab Papers' onclick='openReference("Papers")'> Article <%= @papers.count%>  </button>
    <% end %>
    <% if @sources.count > 0 %>
      <button class = 'reference-tab Sources' onclick='openReference("Sources")'> Images <%= @sources.count%>  </button>
    <% else %>
      <button class = 'reference-tab Sources' onclick='openReference("Sources")'> Image <%= @sources.count%>  </button>
    <% end %>
  </div>

  <div id = 'reference'>

    <% if current_user %>
      <% if current_user.username == @note.user.username %>
        <div id = 'Add' class = 'click-reference' style = ''>
          <div id = 'Added-Reference' style = 'text-align: center; color: #EAB38B;'>
          </div>
          <div style = 'background-color: #3b5998;'>
            <p style = 'margin-bottom: 10px; padding: 5px; font-size: 15px; color: white;'> Now that you have created your Picnote, add any references that you may have used! </p>
          </div>
          <%= simple_form_for([@note, @reference], remote: true, :html => {:id => 'reference_form'}) do |f| %>
            <div>
              <%= f.input :file_type, collection: Reference::TYPE %>
              <div id="generic-content">
                <%= f.input :title %>
                <%= f.input :author %>

              </div>
              <div id="image-source-content">
                <%= f.input :image_source , as: :text, :input_html => { :cols => 5, :rows => 5 } %>
              </div>
              <%= f.input :link %>
            </div>
            <div class = 'form-btn-container text-center'>
              <%= f.button :submit, :class => 'blue-appearance-btn' %>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>

    <div id = 'Textbooks' class = 'click-reference'>
      <%= render @textbooks %>
    </div>

    <div id = 'Videos' class = 'click-reference' style = 'display: none;'>
      <%= render @videos %>
    </div>

    <div id = 'Papers' class = 'click-reference' style = 'display: none;'>
      <%= render @papers %>
    </div>

    <div id = 'Sources' class = 'click-reference' style = 'display: none;'>
      <%= render @sources %>
    </div>
  </div>
</div>
